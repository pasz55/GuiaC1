angular.module("starter").factory("Facebook",function($cacheFactory,$pwaRequest,Url){var factory={value_id:null,token:null,username:null,page_urls:[],displayed_per_page:22,cache:$cacheFactory("facebook"),host:"https://graph.facebook.com/v2.7/",host_img:"https://graph.facebook.com/v2.7/"};return factory.setValueId=function(value_id){factory.value_id=value_id},factory.preFetch=function(){factory.loadData().then(function(){factory.findUser().then(function(){factory.findPosts()})})},factory.getPictureUrl=function(picture_id,size){return factory.host_img+picture_id+"/picture?width="+size+"&access_token="+factory.token},factory.loadData=function(refresh){return this.value_id?$pwaRequest.get("social/mobile_facebook_list/find",{urlParams:{value_id:this.value_id,need_token:!this.token},withCredentials:!1,refresh:refresh}).then(function(response){return factory.username=response.username,response.token&&(factory.token=response.token),response}):$pwaRequest.reject("[Factory::Facebook.loadData] missing value_id")},factory.findUser=function(){var url=Url.build(factory.host+factory.username,{fields:"id,about,name,genre,cover,fan_count,likes,talking_about_count",access_token:this.token});return factory.get(url)},factory.findPosts=function(){var url=Url.build(factory.host+factory.username,{fields:"posts.fields(from,message,full_picture,picture,created_time,likes,comments,type,object_id,name,link)",access_token:factory.token});return angular.isDefined(factory.page_urls.posts)&&(url=factory.page_urls.posts),factory.get(url)},factory.findPost=function(post_id){var url=Url.build(factory.host+post_id,{fields:"from,message,description,full_picture,created_time,likes,comments,object_id,type,name,link",access_token:factory.token});return factory.get(url)},factory.findComments=function(){return factory.get(factory.page_urls.comments)},factory.get=function(url){return $pwaRequest.get(url,{withCredentials:!1})},factory});