angular.module("starter").controller("CategoryListController",function($filter,$scope,$state,$stateParams,Catalog){angular.extend($scope,{is_loading:!1,value_id:$stateParams.value_id,collection:[],use_pull_refresh:!0,pull_to_refresh:!1,card_design:!1}),Catalog.setValueId($stateParams.value_id),$scope.loadContent=function(pullToRefresh){$scope.is_loading=!0,Catalog.findAll(pullToRefresh).then(function(data){if(data.page_title&&($scope.page_title=data.page_title),$scope.categories=data.categories,$scope.tooltip={collection:$scope.categories,current_item:$scope.categories[0],button_label:$scope.categories[0]?$scope.categories[0].name:null,onItemClicked:function(category){$scope.showTooltip(category)}},$scope.categories.length){var last_category=_.filter($scope.categories,_.matches({name:_.get(Catalog.getLastCategory(),"name",null)}));if(1===last_category.length)$scope.showTooltip(last_category[0]);else{var category=$scope.categories[0];category.children&&(category=category.children[0]),$scope.current_category=category,$scope.showTooltip($scope.current_category)}}}).then(function(){$scope.pull_to_refresh&&($scope.$broadcast("scroll.refreshComplete"),$scope.pull_to_refresh=!1),$scope.is_loading=!1})},$scope.pullToRefresh=function(){$scope.pull_to_refresh=!0,$scope.loadContent(!0)},$scope.showTooltip=function(category){category.children?category.show_children=!category.show_children:($scope.collection=category.collection,$scope.collection_chunks=$filter("chunk")($scope.collection,2),$scope.current_category=category,$scope.tooltip.current_item=$scope.current_category,$scope.tooltip.button_label=$scope.current_category.name,Catalog.collection=category.collection,Catalog.setLastCategory(category))},$scope.showItem=function(item){$state.go("catalog-product-view",{value_id:$scope.value_id,product_id:item.id})},$scope.loadContent(!1)}).controller("CategoryProductViewController",function($scope,$stateParams,Catalog){angular.extend($scope,{is_loading:!1,value_id:$stateParams.value_id,product_id:$stateParams.product_id,card_design:!0}),Catalog.setValueId($stateParams.value_id),$scope.loadContent=function(){$scope.is_loading=!0,Catalog.getProduct($scope.product_id).then(function(product){$scope.product=product,$scope.page_title=product.name}).then(function(){$scope.is_loading=!1})},$scope.loadContent()});