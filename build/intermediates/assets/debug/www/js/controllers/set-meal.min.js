angular.module("starter").controller("SetMealListController",function($filter,$scope,$state,$stateParams,$timeout,SetMeal){angular.extend($scope,{is_loading:!0,value_id:$stateParams.value_id,displayed_per_page:10,load_more:!1,use_pull_refresh:!0,pull_to_refresh:!1,card_design:!1}),SetMeal.setValueId($stateParams.value_id),$scope.loadContent=function(loadMore){$scope.is_loading=!0,SetMeal.findAll(SetMeal.collection.length,!1).then(function(data){return data.collection.length?(SetMeal.collection=SetMeal.collection.concat(data.collection),$scope.collection=SetMeal.collection,$scope.collection_chunks=$filter("chunk")($scope.collection,2)):($scope.collection=SetMeal.collection,$scope.collection_chunks=$filter("chunk")($scope.collection,2)),$scope.displayed_per_page=data.displayed_per_page,$scope.page_title=data.page_title,data}).then(function(data){loadMore&&$scope.$broadcast("scroll.infiniteScrollComplete"),$scope.is_loading=!1,$timeout(function(){$scope.load_more=data.collection.length===$scope.displayed_per_page},250)})},$scope.loadMore=function(){$scope.loadContent(!0)},$scope.pullToRefresh=function(){$scope.pull_to_refresh=!0,$scope.load_more=!1,SetMeal.findAll(0,!0).then(function(data){data.collection&&(SetMeal.collection=data.collection,$scope.collection=SetMeal.collection),$scope.load_more=data.collection.length===data.displayed_per_page}).then(function(){$scope.$broadcast("scroll.refreshComplete"),$scope.pull_to_refresh=!1})},$scope.showItem=function(item){$state.go("set-meal-view",{value_id:$scope.value_id,set_meal_id:item.id})},$scope.loadContent(!1)}).controller("SetMealViewController",function($ionicHistory,$scope,$stateParams,Loader,SetMeal){angular.extend($scope,{is_loading:!1,value_id:$stateParams.value_id}),SetMeal.setValueId($stateParams.value_id),SetMeal.setSetMealId($stateParams.set_meal_id),$scope.loadContent=function(){Loader.show(),SetMeal.getSetMeal().then(function(set_meal){$scope.set_meal=set_meal,$scope.page_title=set_meal.name},function(){$ionicHistory.goBack()}).then(function(){Loader.hide()})},$scope.loadContent()});