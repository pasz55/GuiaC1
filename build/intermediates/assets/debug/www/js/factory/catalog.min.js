angular.module("starter").factory("Catalog",function($pwaRequest){var factory={value_id:null,last_category:null,collection:[],extendedOptions:{}};return factory.setValueId=function(value_id){factory.value_id=value_id},factory.setLastCategory=function(category){factory.last_category=category},factory.getLastCategory=function(){return factory.last_category},factory.setExtendedOptions=function(options){factory.extendedOptions=options},factory.preFetch=function(){factory.findAll()},factory.findAll=function(refresh){return this.value_id||$pwaRequest.reject("[Factory::Catalog.findAll] missing value_id"),$pwaRequest.get("catalog/mobile_category_list/findall",angular.extend({urlParams:{value_id:this.value_id},refresh:refresh},factory.extendedOptions))},factory.find=function(product_id){return this.value_id||$pwaRequest.reject("[Factory::Catalog.find] missing value_id"),$pwaRequest.get("catalog/mobile_category_product_view/find",{urlParams:{value_id:this.value_id,product_id:product_id}})},factory.getProduct=function(product_id){if(!this.value_id)return $pwaRequest.reject("[Factory::Catalog.getProduct] missing value_id");var product=_.get(_.filter(factory.collection,function(product){return product.id==product_id})[0],"embed_payload",!1);return product?$pwaRequest.resolve(product):factory.find(product_id)},factory});