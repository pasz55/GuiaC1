angular.module("starter").factory("Booking",function($pwaRequest){var factory={value_id:null,cache_key:null,cache_key_prefix:"feature_booking_",extendedOptions:{}};return factory.setValueId=function(value_id){factory.value_id=value_id,factory.cache_key=factory.cache_key_prefix+value_id},factory.setExtendedOptions=function(options){factory.extendedOptions=options},factory.findStores=function(){if(!this.value_id)return $pwaRequest.reject("[Factory::Booking.findStores] missing value_id");var payload=$pwaRequest.getPayloadForValueId(factory.value_id);return!1!==payload?$pwaRequest.resolve(payload):$pwaRequest.get("booking/mobile_view/find",angular.extend({urlParams:{value_id:this.value_id}},factory.extendedOptions))},factory.submitForm=function(form){if(!this.value_id)return $pwaRequest.reject("[Factory::Booking.submitForm] missing value_id");var data={};for(var prop in form)data[prop]=form[prop];if(data.value_id=this.value_id,data.date){var date=new Date(data.date),zeroPad=function(e){return("00"+e).slice(-2)};data.date=date.getFullYear()+"-"+zeroPad(date.getMonth()+1)+"-"+zeroPad(date.getDate())+"T"+zeroPad(date.getHours())+":"+zeroPad(date.getMinutes())+":"+zeroPad(date.getSeconds())+"-00:00"}return $pwaRequest.post("booking/mobile_view/post",{urlParams:{value_id:this.value_id},data:data,cache:!1})},factory});